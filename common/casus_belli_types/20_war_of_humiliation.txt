cb_war_of_humiliation = {
	icon = war_of_humiliation
	group = war_of_humiliation

	combine_into_one = yes
	should_show_war_goal_subview = yes

	allowed_for_character = {
		OR = {
			AND = { 
				debt_level >= 2
				is_ai = yes
			}
			AND = { 
				is_ai = no
			}
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
	}

	valid_to_start = {
		# No specific conditions to allow free use
	}

	on_declaration = {
		on_declared_war = yes
	}

	cost = {
		prestige = {
			value = 25
			add = {
				value = 5
				multiply = scope:defender.realm_size
				desc = "Additional prestige cost for larger defender"
			}
		}
	}

	on_victory_desc = {
		desc = "cb_war_of_humiliation_victory_desc"
	}

	on_victory = {
	scope:defender = {
		pay_short_term_income = { years = 2 target = scope:attacker }
		add_prestige_level = -1
		add_legitimacy = {
			value = -100
			desc = "Legitimacy multiplied by defender's realm size"
		}
	}
	scope:attacker = {
		show_pow_release_message_effect = yes
		add_legitimacy = {
			value = 100
			desc = "Legitimacy multiplied by defender's realm size"
		}
		add_prestige = {
			value = 750
			desc = "Prestige multiplied by defender's realm size"
		}
		add_prestige_experience = 250
	}
	modify_allies_of_participants_fame_values = {
		WINNER = scope:attacker
		LOSER = scope:defender
		FAME_BASE = 50
		IS_RELIGIOUS_WAR = no
		WINNER_FAME_SCALE = 1
		LOSER_FAME_SCALE = -1
		WINNER_ALLY_FAME_SCALE = 1
		LOSER_ALLY_FAME_SCALE = 1
	}
	add_truce_attacker_victory_effect = yes
}

	on_defeat_desc = {
		desc = "cb_war_of_humiliation_defeat_desc"
	}

	on_defeat = {
		scope:attacker = {
			show_pow_release_message_effect = yes
			add_legitimacy = -50
			add_prestige = -100
			pay_short_term_income = { years = 1 target = scope:defender }
		}
		scope:defender = {
			add_legitimacy = 50
			add_prestige = 100
		}
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			LOSER = scope:attacker
			FAME_BASE = 50
			IS_RELIGIOUS_WAR = no
			WINNER_FAME_SCALE = 1
			LOSER_FAME_SCALE = -1
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		add_truce_attacker_defeat_effect = yes
	}

	on_invalidated_desc = {
		desc = "cb_war_of_humiliation_invalidated_desc"
	}

	on_invalidated = {
		# Define invalidated actions if any
	}
	
	ai_score_mult = {
		value = 10
	}

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	transfer_behavior = transfer

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "War for Humiliation and Control"
	cb_name_no_target = "War for Humiliation and Control"

	interface_priority = 1

	attacker_wargoal_percentage = 0.8

	should_show_war_goal_subview = yes
}